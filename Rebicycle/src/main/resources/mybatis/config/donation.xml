<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- MyBatis에서 namespace는 필수적으로 명시해야 함 -->

 <mapper namespace="donation">   
 <resultMap type="donationVO" id="donationRM">
 <result column="donation_bicycle_no" property="donationBicycleNo"/>
 <result column="donor_id" property="donorId"/>
 <result column="photo1" property="photoVO.photo1"/>
 <result column="photo2" property="photoVO.photo2"/>
 <result column="photo3" property="photoVO.photo3"/>	
 </resultMap>
<insert id="registerDonation" parameterType="donationVO">
<selectKey order="BEFORE" keyProperty="donationBicycleNo" resultType="int">
	select donation_seq.nextval from dual
</selectKey>
	insert into donation(donation_bicycle_no,donor_id,address,title,detail,photo1,photo2,photo3)
	values(#{donationBicycleNo},#{donorId},#{address},#{title},#{detail},#{photoVO.photo1},#{photoVO.photo2},#{photoVO.photo3})
</insert> 	
<select id="getTotalContentsNo" resultType="string">
select count(*) from donation
</select>
<select id="getDonationList" parameterType="pagingBean" resultMap="donationRM">
select d.donation_bicycle_no,d.donor_id,d.address, d.detail,d.photo1,d.title
from (select donation_bicycle_no,donor_id,address,detail,photo1,title,
 row_number() over(order by donation_bicycle_no desc) rnum from donation where status=0) D
 where rnum between #{startRowNumber} and #{endRowNumber}
</select>
<select id="findDonationDetailByNo" parameterType="int" resultMap="donationRM">
	select donation_bicycle_no,donor_id, address, detail,photo1,photo2,photo3,title from donation where donation_bicycle_no=#{value}
</select>
 </mapper>
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

















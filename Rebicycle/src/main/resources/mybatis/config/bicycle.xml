<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- MyBatis에서 namespace는 필수적으로 명시해야 함 -->

 <mapper namespace="bicycle">   
 	<insert id="registerBicycle" parameterType="bicycleVO">
 		<selectKey keyProperty="bicycleNo" resultType="int" order="BEFORE">
			select bicycle_seq.nextval from dual
		</selectKey>
 		insert into bicycle(bicycleNo, memberId, address, purchasePrice, rentPrice, detail, categoryNo) 
 		values(#{bicycleNo}, #{memberVO.id}, #{address}, #{purchasePrice}, #{rentPrice}, #{detail}, #{categoryNo})
 	</insert>
 	<select id="findCategoryByNo" resultType="string">
 		select categoryName from category where categoryNo=#{categoryNo}
 	</select>
 	<select id="findBicycleByNo" resultType="bicycleVO">
 		select bicycleNo,memberId,address,purchasePrice,rentPrice,detail,categoryNo from bicycle where bicycleNo=#{bicycleNo}
 	</select>
 	<select id="getBicycleListByAddressAndDay" parameterType="map" resultType="bicycleVO">
 		select b.bicycleNo, b.memberId ,b.address ,b.purchasePrice ,b.rentPrice , b.detail ,b.categoryNo,p.startDay,p.endDay ,bp.photo1,bp.photo2,bp.photo3
		from bicycle b, possible_day p, bicycle_photo bp  
		where b.address like '%'||${address}||'%' and b.bicycleNo=p.bicycleNo and to_date(${startDay})>=p.startDay and to_date(${endDay})<=p.endDay and b.bicycleNo=bp.bicycleNo
 	</select>
 </mapper>

 
 
 
 
 
 
 
 
 
 
 
 
















